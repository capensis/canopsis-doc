

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Snmp &mdash; Canopsis 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Canopsis 1.0 documentation" href="../../../index.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> Canopsis
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../canopsis/index.html">Canopsis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../canopsis-connectors/index.html">Canopsis Connectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../canopsis-ui-bricks/index.html">Canopsis Ui Bricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Cat</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../index.html">Canopsis</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">Docs</a> &raquo;</li>
      
    <li>Snmp</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/cat/canopsis-cat/snmp/ed_snmp.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="snmp">
<span id="ed-snmp"></span><h1><a class="toc-backref" href="#id2">Snmp</a><a class="headerlink" href="#snmp" title="Permalink to this headline">¶</a></h1>
<p>This guide gives information about how to use the snmp system as a end user.</p>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#snmp" id="id2">Snmp</a><ul>
<li><a class="reference internal" href="#references" id="id3">References</a></li>
<li><a class="reference internal" href="#updates" id="id4">Updates</a></li>
<li><a class="reference internal" href="#id1" id="id5">Contents</a><ul>
<li><a class="reference internal" href="#snmp-engine-user" id="id6">SNMP Engine User</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="references">
<h2><a class="toc-backref" href="#id3">References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><span class="xref std std-ref">TR::Snmp technical requirements</span></li>
<li><span class="xref std std-ref">FR::Snmp functional requirements</span></li>
</ul>
</div>
<div class="section" id="updates">
<h2><a class="toc-backref" href="#id4">Updates</a><a class="headerlink" href="#updates" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Author(s)</th>
<th class="head">Date</th>
<th class="head">Version</th>
<th class="head">Summary</th>
<th class="head">Accepted by</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Eric Régnier</td>
<td>2015/11/23</td>
<td>0.1</td>
<td>Document uses template</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id1">
<h2><a class="toc-backref" href="#id5">Contents</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<div class="section" id="snmp-engine-user">
<h3><a class="toc-backref" href="#id6">SNMP Engine User</a><a class="headerlink" href="#snmp-engine-user" title="Permalink to this headline">¶</a></h3>
<p><cite>Canopsis Administration Tools</cite> comes with an engine designed to translate SNMP Traps generated by  <a class="reference external" href="https://git.canopsis.net/cat/connector-snmp2canopsis">snmp2canopsis connector</a></p>
<p>In order to use that engine, you <strong>NEED</strong> to setup snmp2canopsis connector the right way.</p>
<div class="section" id="mibs-upload">
<h4>MIBS Upload<a class="headerlink" href="#mibs-upload" title="Permalink to this headline">¶</a></h4>
<p>In order to translate trap messages into check messages, snmp engine has to translate OIDs.
To to such thing, MIBs are necessary.</p>
<p>In <cite>view.snmprule</cite> (View manager -&gt; Search -&gt; snmprule -&gt; view), you can upload mibs</p>
<img alt="../../../_images/upload1.png" src="../../../_images/upload1.png" />
<p>Select MIB files to Upload. Multiple select is accepted.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Sometimes, MIBs modules depend on other modules. For now, upload process is not able to import modules in the right order. Note that <cite>alphabetical</cite> order is used to concatenate files</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Many mib files may be uploaded at the same time. When this happens, the canopsis UI sorts MIB files by filename. That&#8217;s the reason why, when mib depends each other, it is necessary to rename the files to upload.</p>
</div>
<p>If your mibs files contain NOTIFICATION TYPE or TRAP-TYPE objects, they will be inserted in a specific data collection (default_mibs).</p>
<img alt="../../../_images/upload2.png" src="../../../_images/upload2.png" />
</div>
<div class="section" id="snmp-rules">
<h4>SNMP Rules<a class="headerlink" href="#snmp-rules" title="Permalink to this headline">¶</a></h4>
<p>It is possible in canopsis to translate SNMP traps to canopsis events by editing snmp translation rules. This can be done by going to the SNMP rule panel in the engine menu. This will take care of possible mib definition that are inserted into Canopsis thanks to the upload button.</p>
<div class="section" id="simple-mode">
<h5>Simple mode<a class="headerlink" href="#simple-mode" title="Permalink to this headline">¶</a></h5>
<p>First, create a rule by clicking on the create button on the top right of the screen. Then the snmp rule editor will appear.</p>
<img alt="../../../_images/rules1.png" src="../../../_images/rules1.png" />
<p>From this form, you have to type the first letter that a mib module should contain, then a list of mib module will be shown. Then select a module in the list</p>
<img alt="../../../_images/rules2.png" src="../../../_images/rules2.png" />
<p>Selecting a module in the list will perform a search for the related module&#8217;s mibs availables mibs. Then on the combobox on the right is the mib names.</p>
<img alt="../../../_images/rules3.png" src="../../../_images/rules3.png" />
<p>Select a mib name will perform a second search that makes available mib objects for selected module. This search contains object names that can be used in templates. object names templates information can be added by just clicking on them. Module objects in template is given to the snmp engine and will be replaced by the value in the trap event <code class="docutils literal"><span class="pre">snmp_vars</span></code> property that have the same oid than the module&#8217;s object one. Clicking on a module object name for a template field will append the right template information to the template.</p>
<img alt="../../../_images/rules4.png" src="../../../_images/rules4.png" />
<p>In the end, you have to choose the status that the snmp engine&#8217;s produced event will wear, and then the rule is over and ready to be hanlded by the snmp engine.</p>
</div>
<div class="section" id="advanced-mode">
<h5>Advanced mode<a class="headerlink" href="#advanced-mode" title="Permalink to this headline">¶</a></h5>
<p>In some cases, translate oid from <cite>snmp_vars</cite> to component, resource, output, state attributes could not be enough.</p>
<p>Let&#8217;s imagine this message received from snmp2canopsis :</p>
<div class="highlight-json"><div class="highlight"><pre><span></span>{&#39;component&#39;: &#39;XXX.XXX.XXX.XXX&#39;,
  &#39;connector&#39;: &#39;snmp&#39;,
  &#39;connector_name&#39;: &#39;snmp2canopsis&#39;,
  &#39;event_type&#39;: &#39;trap&#39;,
  &#39;snmp_timeticks&#39;: &#39;2592518722&#39;,
  &#39;snmp_trap_oid&#39;: &#39;1.3.6.1.4.1.5528.100.10.3&#39;,
  &#39;snmp_vars&#39;: {&#39;1.3.6.1.4.1.5528.100.11.1&#39;: &#39;nbErrorCond_D0B11ADF&#39;,
               &#39;1.3.6.1.4.1.5528.100.11.10&#39;: &#39;1438008965&#39;,
               &#39;1.3.6.1.4.1.5528.100.11.11&#39;: &#39;1438008965&#39;,
               &#39;1.3.6.1.4.1.5528.100.11.12&#39;: &#39;0&#39;,
               &#39;1.3.6.1.4.1.5528.100.11.13&#39;: &#39;4&#39;,
               &#39;1.3.6.1.4.1.5528.100.11.14&#39;: &#39;&#39;,
               &#39;1.3.6.1.4.1.5528.100.11.15&#39;: &#39;0&#39;,
               &#39;1.3.6.1.4.1.5528.100.11.16&#39;: &#39;0&#39;,
               &#39;1.3.6.1.4.1.5528.100.11.2&#39;: &#39;nbErrorType_podunpluggedsensor&#39;,
               &#39;1.3.6.1.4.1.5528.100.11.3&#39;: &#39;Perte de communication&#39;,
               &#39;1.3.6.1.4.1.5528.100.11.4&#39;: &#39;&#39;,
               &#39;1.3.6.1.4.1.5528.100.11.5&#39;: &#39;&#39;,
               &#39;1.3.6.1.4.1.5528.100.11.6&#39;: &#39;nbSNMPEncCC7A4999&#39;,
               &#39;1.3.6.1.4.1.5528.100.11.7&#39;: &#39;component name (XXX.XXX.XXX.XXX)&#39;,
               &#39;1.3.6.1.4.1.5528.100.11.8&#39;: &#39;&#39;,
               &#39;1.3.6.1.4.1.5528.100.11.9&#39;: &#39;&#39;},
 &#39;snmp_version&#39;: &#39;1&#39;,
 &#39;source_type&#39;: &#39;component&#39;,
 &#39;state&#39;: 3,
 &#39;state_type&#39;: 1,
 &#39;timestamp&#39;: 1438008970.011169
}
</pre></div>
</div>
<p>It is possible to use <cite>1.3.6.1.4.1.5528.100.11.7̀</cite>  in snmp_vars as component name for translation.
the problem is that you&#8217;re just interested with <cite>component name</cite> and not with the IP Address.</p>
<p>In rule editor, you can use the advanced mode</p>
<img alt="../../../_images/rules6.png" src="../../../_images/rules6.png" />
<p>In the second input, you can write a regex to extract the string you need.</p>
<img alt="../../../_images/rules5.png" src="../../../_images/rules5.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Only first group (in parenthesis) will be used</p>
</div>
<p>The advanced mode is available for all listed attributes with a special thing for state.</p>
<p>Click on</p>
<img alt="../../../_images/rules7.png" src="../../../_images/rules7.png" />
<p>Then you have to specify a regex for states you want to.
Here is an example :</p>
<img alt="../../../_images/rules8.png" src="../../../_images/rules8.png" />
<p>SNMP engine will translate the string &#8220;Reset/Resolved&#8221; to a state &#8220;Info (0)&#8221; in a Canopsis event</p>
</div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Capensis.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>