

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>User preferences &mdash; Canopsis 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Canopsis 1.0 documentation" href="../../../../../index.html"/>
        <link rel="up" title="Widgets" href="index.html"/>
        <link rel="next" title="Category chart" href="category-chart.html"/>
        <link rel="prev" title="Using Performance Data" href="perfdata.html"/> 

  
  <script src="../../../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../../../index.html" class="icon icon-home"> Canopsis
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../../index.html">Canopsis</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../index.html">Sakura</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../overview/index.html">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../user-guide/index.html">User guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../administrator-guide/index.html">Administrator guide</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../index.html">Developer guide</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../best-practices/index.html">Best Practices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../specifications/index.html">Specifications</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../backend/index.html">Backend</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../index.html">Frontend</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/index.html">API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../glossary.html">Glossary</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../index.html#canopsis-specification">Canopsis Specification</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../canopsis-connectors/index.html">Canopsis Connectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../canopsis-ui-bricks/index.html">Canopsis Ui Bricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../cat/index.html">Cat</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../../../index.html">Canopsis</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../../../index.html">Canopsis</a> &raquo;</li>
      
          <li><a href="../../../index.html">Sakura</a> &raquo;</li>
      
          <li><a href="../../index.html">Developer guide</a> &raquo;</li>
      
          <li><a href="../index.html">Frontend</a> &raquo;</li>
      
          <li><a href="index.html">Widgets</a> &raquo;</li>
      
    <li>User preferences</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../../../_sources/canopsis/canopsis/developer-guide/frontend/widgets/user-preferences.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="user-preferences">
<span id="dev-frontend-widgets-userpref"></span><h1>User preferences<a class="headerlink" href="#user-preferences" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>User preferences in canopsis allow a user to store a widget statement into database making this widget having a specific state at application load.
Thus, a user preference is stored in the user preference mongo collection and <strong>is identified with both a user id and a widget id</strong>.</p>
</div>
<div class="section" id="implementation">
<h2>Implementation<a class="headerlink" href="#implementation" title="Permalink to this headline">¶</a></h2>
<p>User preferences in canopsis is a document that allow developers to save a widget user&#8217;s statement into json format within the user preference database collection.
These user preference will be loaded at widget (re)load and will give it a statement that will render it different for a single widget to different users.</p>
<p>To declare a new user preference, open the schema of the model in which the user preference will be set. The property managed as an user preference is actually like any other schema property, but with a &#8220;isUserPreference&#8221; option set to true.</p>
<p>That&#8217;s it. The Ember model class generated have a submodel dedicated to store user preferences, accessible via the &#8216;userPreferencesModel&#8217; key, and the preferences values can be accessed from the model instance directly.</p>
</div>
<div class="section" id="persistance">
<h2>Persistance<a class="headerlink" href="#persistance" title="Permalink to this headline">¶</a></h2>
<p>User preferences are loaded when the model instance is loaded, and saved when the user model is saved. But on some cases, developers might want to save user preferences only, without saving the whole model.</p>
<p>This is done thanks to the <strong>userconfiguration</strong> <a class="reference external" href="http://emberjs.com/api/classes/Ember.Mixin.html">Ember js mixin</a> that add a method to the (widget) controller using it.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">saveUserConfiguration</span></code> is called by the developper to trigger data save to the mongo collection for the widget it is called on.</li>
</ul>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>Let say the widget text have a custom title for each user to save, then in the user interface the user will be able to fill a text field with a custom title. A user action will then tell the widget to set the title in <code class="docutils literal"><span class="pre">userParams</span></code> javascript object.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>

   <span class="s1">&#39;...&#39;</span><span class="o">:</span> <span class="s1">&#39;...&#39;</span><span class="p">,</span>

   <span class="s2">&quot;properties&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;customTitle&quot;</span><span class="o">:</span> <span class="p">{</span>
         <span class="s2">&quot;isUserPreference&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
         <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span>
      <span class="p">},</span>

      <span class="s1">&#39;...&#39;</span><span class="o">:</span> <span class="s1">&#39;...&#39;</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">set</span><span class="p">(</span><span class="nx">widgetController</span><span class="p">,</span> <span class="s1">&#39;model.customTitle&#39;</span><span class="p">,</span> <span class="s1">&#39;user input title&#39;</span><span class="p">);</span>
<span class="nx">widgetController</span><span class="p">.</span><span class="nx">saveUserConfiguration</span><span class="p">();</span>
</pre></div>
</div>
<p>Then run saveUserConfiguration will filldatabase with a document that looks like:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="nx">widgetId</span><span class="o">:</span> <span class="s1">&#39;widgetGUID_aUserId&#39;</span><span class="p">,</span>
   <span class="s1">&#39;userId&#39;</span><span class="o">:</span> <span class="s1">&#39;aUserId&#39;</span><span class="p">,</span>
   <span class="s1">&#39;widget_preferences&#39;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s1">&#39;customTitle&#39;</span><span class="o">:</span> <span class="s1">&#39;user input title&#39;</span><span class="p">,</span>
      <span class="s1">&#39;anotherPreference&#39;</span><span class="o">:</span> <span class="s1">&#39;aPreferenceValue&#39;</span>
   <span class="p">}</span>
   <span class="s1">&#39;...&#39;</span><span class="o">:</span> <span class="s1">&#39;...&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>At widget initilization, this previous document is loaded into the widget and the model is filled with the appropriate fields.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="category-chart.html" class="btn btn-neutral float-right" title="Category chart" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="perfdata.html" class="btn btn-neutral" title="Using Performance Data" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Capensis.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>